name = "chinese-learning-api"
main = "src/index.ts"
compatibility_date = "2024-05-29"

# D1 Database
# After running `wrangler d1 create chinese-learning-db`, replace the database_id below
[[d1_databases]]
binding = "DB"
database_name = "chinese-learning-db"
database_id = "b1ccbb96-0328-4c36-95d8-d7fe18171d82"
migrations_dir = "src/db/migrations"

# R2 Bucket for audio files
# Create with: `wrangler r2 bucket create chinese-learning-audio`
[[r2_buckets]]
binding = "AUDIO_BUCKET"
bucket_name = "chinese-learning-audio"

# Environment variables (secrets set via wrangler secret or dashboard)
# Set secrets with: `wrangler secret put <SECRET_NAME>`
# Required secrets:
# - ANTHROPIC_API_KEY: Anthropic API key for AI features
# - GOOGLE_TTS_API_KEY: Google Cloud TTS API key
# - GOOGLE_CLIENT_ID: Google OAuth client ID
# - GOOGLE_CLIENT_SECRET: Google OAuth client secret
# - SESSION_SECRET: Random secret for session signing (openssl rand -base64 32)
# - ADMIN_EMAIL: Email address of the admin user
# - NTFY_TOPIC: ntfy.sh topic for new user notifications
[vars]
ENVIRONMENT = "production"

# Local development settings
[dev]
port = 8787

# Frontend is deployed separately to Cloudflare Pages
# See .github/workflows/deploy.yml
